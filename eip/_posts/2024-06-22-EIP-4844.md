## EIP-4844

https://www.cyfrin.io/blog/what-is-eip-4844-proto-danksharding-and-blob-transactions


### How do rollups validate transactions now?

1. You submit a transaction with a blob, along with some proof data

你提交了一个包含blob的transaction，并附上一些证明数据

2. Your contract on-chain accesses a hash of the blob with the BLOBHASH opcode

你的链上合约通过BLOBHASH指令访问了这个blob的哈希值。

3. It then will pass your blob-hash combined with your proof data to the new point evaluation opcode to help verify the transactions batch 

然后会将你的 blob-hash 与证明数据一起`new point evaluation opcode`来帮助验证batch中的 transaction 的正确性。

备注: 这步骤只能验证你上传到blob和你的证明数据是一一对应的并且是正确的, 并不能证明你的L2上的交易都是validated.


```mermaid

    sequenceDiagram
        participant User as 用户
        participant Blockchain as 区块链
        participant Verifier as 验证者

        User->>User: 准备数据
        User->>User: 转换为十六进制
        User->>User: 生成Blob
        User->>User: 生成KZG承诺
        User->>Blockchain: 提交承诺和元数据
        Blockchain->>Blockchain: 存储承诺和元数据

        Verifier->>Blockchain: 请求验证Blob属性
        Blockchain->>User: 请求证明信息
        User->>Verifier: 提供证明信息
        Verifier->>Verifier: 验证Blob属性
        Verifier->>Verifier: 确认有效性

```

```mermaid

sequenceDiagram
    participant User
    participant Layer2
    participant EthereumMainnet
    participant BlobStorage

    User->>Layer2: Initiate Transaction with Calldata
    Layer2->>BlobStorage: Store Calldata as Blob
    BlobStorage-->>Layer2: Return Blob Reference
    Layer2->>EthereumMainnet: Submit Transaction with Blob Reference
    EthereumMainnet-->>Layer2: Confirm Transaction Inclusion
    Layer2-->>User: Confirm Transaction Completion
```